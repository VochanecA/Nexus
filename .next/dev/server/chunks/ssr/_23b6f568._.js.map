{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/GitHubNovi/Nexus/components/ui/avatar.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as AvatarPrimitive from '@radix-ui/react-avatar'\n\nimport { cn } from '@/lib/utils'\n\nfunction Avatar({\n  className,\n  ...props\n}: React.ComponentProps<typeof AvatarPrimitive.Root>) {\n  return (\n    <AvatarPrimitive.Root\n      data-slot=\"avatar\"\n      className={cn(\n        'relative flex size-8 shrink-0 overflow-hidden rounded-full',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction AvatarImage({\n  className,\n  ...props\n}: React.ComponentProps<typeof AvatarPrimitive.Image>) {\n  return (\n    <AvatarPrimitive.Image\n      data-slot=\"avatar-image\"\n      className={cn('aspect-square size-full', className)}\n      {...props}\n    />\n  )\n}\n\nfunction AvatarFallback({\n  className,\n  ...props\n}: React.ComponentProps<typeof AvatarPrimitive.Fallback>) {\n  return (\n    <AvatarPrimitive.Fallback\n      data-slot=\"avatar-fallback\"\n      className={cn(\n        'bg-muted flex size-full items-center justify-center rounded-full',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Avatar, AvatarImage, AvatarFallback }\n"],"names":[],"mappings":";;;;;;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,OAAO,EACd,SAAS,EACT,GAAG,OAC+C;IAClD,qBACE,8OAAC,0KAAoB;QACnB,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,8DACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,8OAAC,2KAAqB;QACpB,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,2BAA2B;QACxC,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,eAAe,EACtB,SAAS,EACT,GAAG,OACmD;IACtD,qBACE,8OAAC,8KAAwB;QACvB,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,oEACA;QAED,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 57, "column": 0}, "map": {"version":3,"sources":["file:///D:/GitHubNovi/Nexus/components/follow/follow-button.tsx"],"sourcesContent":["// components/follow/follow-button.tsx\r\n\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { UserPlus, UserCheck, Loader2 } from \"lucide-react\";\r\nimport { createClient } from \"@/lib/supabase/client\";\r\nimport { toast } from \"sonner\";\r\n\r\ninterface FollowButtonProps {\r\n  followerId: string;\r\n  followingId: string;\r\n  isFollowing: boolean;\r\n  className?: string;\r\n  size?: \"default\" | \"sm\" | \"lg\" | \"icon\";\r\n  variant?: \"default\" | \"destructive\" | \"outline\" | \"secondary\" | \"ghost\" | \"link\";\r\n  onFollowChange?: (isFollowing: boolean) => void;\r\n}\r\n\r\nexport function FollowButton({\r\n  followerId,\r\n  followingId,\r\n  isFollowing: initialIsFollowing,\r\n  className = \"\",\r\n  size = \"sm\",\r\n  variant,\r\n  onFollowChange,\r\n}: FollowButtonProps) {\r\n  const [isFollowing, setIsFollowing] = useState(initialIsFollowing);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const supabase = createClient();\r\n\r\n  const handleFollowToggle = async () => {\r\n    if (!followerId || !followingId) return;\r\n    \r\n    setIsLoading(true);\r\n    \r\n    try {\r\n      if (isFollowing) {\r\n        // Unfollow\r\n        const { error } = await supabase\r\n          .from(\"follows\")\r\n          .delete()\r\n          .eq(\"follower_id\", followerId)\r\n          .eq(\"following_id\", followingId);\r\n        \r\n        if (error) throw error;\r\n        \r\n        setIsFollowing(false);\r\n        toast.success(\"Unfollowed\");\r\n      } else {\r\n        // Follow\r\n        const { error } = await supabase\r\n          .from(\"follows\")\r\n          .insert({\r\n            follower_id: followerId,\r\n            following_id: followingId,\r\n          });\r\n        \r\n        if (error) {\r\n          // Možda već postoji\r\n          if (error.code === '23505') { // Unique violation\r\n            setIsFollowing(true);\r\n          } else {\r\n            throw error;\r\n          }\r\n        } else {\r\n          setIsFollowing(true);\r\n        }\r\n        toast.success(\"Following\");\r\n      }\r\n      \r\n      onFollowChange?.(!isFollowing);\r\n    } catch (error) {\r\n      console.error(\"Error toggling follow:\", error);\r\n      toast.error(\"Failed to update follow status\");\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Odredite variant na osnovu isFollowing\r\n  const buttonVariant = variant || (isFollowing ? \"outline\" : \"default\");\r\n\r\n  return (\r\n    <Button\r\n      size={size}\r\n      variant={buttonVariant}\r\n      onClick={handleFollowToggle}\r\n      disabled={isLoading || followerId === followingId}\r\n      className={`gap-2 ${className}`}\r\n    >\r\n      {isLoading ? (\r\n        <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n      ) : isFollowing ? (\r\n        <>\r\n          <UserCheck className=\"h-4 w-4\" />\r\n          <span className=\"hidden sm:inline\">Following</span>\r\n        </>\r\n      ) : (\r\n        <>\r\n          <UserPlus className=\"h-4 w-4\" />\r\n          <span className=\"hidden sm:inline\">Follow</span>\r\n        </>\r\n      )}\r\n    </Button>\r\n  );\r\n}"],"names":[],"mappings":"AAAA,sCAAsC;;;;;;AAGtC;AACA;AACA;AAAA;AAAA;AACA;AACA;AANA;;;;;;;AAkBO,SAAS,aAAa,EAC3B,UAAU,EACV,WAAW,EACX,aAAa,kBAAkB,EAC/B,YAAY,EAAE,EACd,OAAO,IAAI,EACX,OAAO,EACP,cAAc,EACI;IAClB,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,iNAAQ,EAAC;IAC/C,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAC3C,MAAM,WAAW,IAAA,yIAAY;IAE7B,MAAM,qBAAqB;QACzB,IAAI,CAAC,cAAc,CAAC,aAAa;QAEjC,aAAa;QAEb,IAAI;YACF,IAAI,aAAa;gBACf,WAAW;gBACX,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SACrB,IAAI,CAAC,WACL,MAAM,GACN,EAAE,CAAC,eAAe,YAClB,EAAE,CAAC,gBAAgB;gBAEtB,IAAI,OAAO,MAAM;gBAEjB,eAAe;gBACf,iJAAK,CAAC,OAAO,CAAC;YAChB,OAAO;gBACL,SAAS;gBACT,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SACrB,IAAI,CAAC,WACL,MAAM,CAAC;oBACN,aAAa;oBACb,cAAc;gBAChB;gBAEF,IAAI,OAAO;oBACT,oBAAoB;oBACpB,IAAI,MAAM,IAAI,KAAK,SAAS;wBAC1B,eAAe;oBACjB,OAAO;wBACL,MAAM;oBACR;gBACF,OAAO;oBACL,eAAe;gBACjB;gBACA,iJAAK,CAAC,OAAO,CAAC;YAChB;YAEA,iBAAiB,CAAC;QACpB,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,0BAA0B;YACxC,iJAAK,CAAC,KAAK,CAAC;QACd,SAAU;YACR,aAAa;QACf;IACF;IAEA,yCAAyC;IACzC,MAAM,gBAAgB,WAAW,CAAC,cAAc,YAAY,SAAS;IAErE,qBACE,8OAAC,qIAAM;QACL,MAAM;QACN,SAAS;QACT,SAAS;QACT,UAAU,aAAa,eAAe;QACtC,WAAW,CAAC,MAAM,EAAE,WAAW;kBAE9B,0BACC,8OAAC,4NAAO;YAAC,WAAU;;;;;mBACjB,4BACF;;8BACE,8OAAC,6NAAS;oBAAC,WAAU;;;;;;8BACrB,8OAAC;oBAAK,WAAU;8BAAmB;;;;;;;yCAGrC;;8BACE,8OAAC,0NAAQ;oBAAC,WAAU;;;;;;8BACpB,8OAAC;oBAAK,WAAU;8BAAmB;;;;;;;;;;;;;AAK7C"}},
    {"offset": {"line": 178, "column": 0}, "map": {"version":3,"sources":["file:///D:/GitHubNovi/Nexus/components/post/post-card.tsx"],"sourcesContent":["// components/post/post-card.tsx\n\"use client\";\n\nimport type React from \"react\";\n\nimport { useState, useEffect } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport Link from \"next/link\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Button } from \"@/components/ui/button\";\nimport { Heart, MessageCircle, LogIn, MoreVertical } from \"lucide-react\";\nimport { createClient } from \"@/lib/supabase/client\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport { FollowButton } from \"@/components/follow/follow-button\";\n\ninterface Post {\n  id: string;\n  content: string;\n  created_at: string;\n  user_id: string;\n  username: string;\n  display_name: string;\n  avatar_url: string | null;\n  likes_count: number;\n  comments_count: number;\n  user_has_liked: boolean;\n}\n\ninterface PostCardProps {\n  post: Post;\n  showFollowButton?: boolean;\n  currentUserId?: string;\n  isCurrentUserFollowing?: boolean;\n  onFollowChange?: (userId: string, isFollowing: boolean) => void;\n}\n\nexport function PostCard({ \n  post, \n  showFollowButton = false,\n  currentUserId,\n  isCurrentUserFollowing = false,\n  onFollowChange\n}: PostCardProps): React.JSX.Element {\n  const router = useRouter();\n  const [liked, setLiked] = useState<boolean>(post.user_has_liked);\n  const [likesCount, setLikesCount] = useState<number>(post.likes_count);\n  const [loading, setLoading] = useState<boolean>(false);\n  const [isAuthenticated, setIsAuthenticated] = useState<boolean>(false);\n  const [authUserId, setAuthUserId] = useState<string | null>(null);\n\n  // Provjera da li je korisnik logovan\n  useEffect(() => {\n    const checkAuth = async (): Promise<void> => {\n      const supabase = createClient();\n      const { data: { user } } = await supabase.auth.getUser();\n      setIsAuthenticated(!!user);\n      setAuthUserId(user?.id || null);\n      \n      // Ažuriraj liked status ako je korisnik logovan\n      if (user) {\n        const { data: like } = await supabase\n          .from(\"likes\")\n          .select(\"id\")\n          .eq(\"post_id\", post.id)\n          .eq(\"user_id\", user.id)\n          .maybeSingle();\n        setLiked(!!like);\n      }\n    };\n    \n    void checkAuth();\n  }, [post.id]);\n\n  // Trenutni korisnik (prioritet: prop > state)\n  const currentUser = currentUserId || authUserId;\n\n  // Da li prati ovog korisnika\n  const isFollowing = isCurrentUserFollowing || false;\n\n  const handleLike = async (e: React.MouseEvent<HTMLButtonElement>): Promise<void> => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    // Ako nije logovan, redirect na login\n    if (!isAuthenticated) {\n      router.push(\"/login\");\n      return;\n    }\n\n    setLoading(true);\n    const supabase = createClient();\n\n    const {\n      data: { user },\n    } = await supabase.auth.getUser();\n\n    if (!user) {\n      router.push(\"/login\");\n      return;\n    }\n\n    try {\n      if (liked) {\n        await supabase\n          .from(\"likes\")\n          .delete()\n          .eq(\"post_id\", post.id)\n          .eq(\"user_id\", user.id);\n        setLiked(false);\n        setLikesCount((prev) => prev - 1);\n      } else {\n        await supabase\n          .from(\"likes\")\n          .insert({ \n            post_id: post.id, \n            user_id: user.id \n          });\n        setLiked(true);\n        setLikesCount((prev) => prev + 1);\n      }\n    } catch (error) {\n      console.error(\"Error toggling like:\", error);\n    } finally {\n      setLoading(false);\n      // Refresh feed da bi se ažurirali broječi\n      router.refresh();\n    }\n  };\n\n  const handleFollowStatusChange = (isFollowing: boolean) => {\n    if (onFollowChange && post.user_id) {\n      onFollowChange(post.user_id, isFollowing);\n    }\n  };\n\n  const handleCardClick = (e: React.MouseEvent<HTMLDivElement>): void => {\n    // Provjeri da li je klik na link ili dugme\n    const target = e.target as HTMLElement;\n    if (target.closest(\"a, button, [role='button']\")) {\n      return;\n    }\n    router.push(`/post/${post.id}`);\n  };\n\n  const handleCommentButtonClick = (e: React.MouseEvent<HTMLButtonElement>): void => {\n    e.preventDefault();\n    e.stopPropagation();\n    \n    // Ako nije logovan, redirect na login\n    if (!isAuthenticated) {\n      router.push(\"/login\");\n      return;\n    }\n    \n    router.push(`/post/${post.id}`);\n  };\n\n  const handleProfileLinkClick = (e: React.MouseEvent<HTMLAnchorElement>): void => {\n    e.stopPropagation();\n  };\n\n  const getInitials = (name: string): string => {\n    return name\n      .split(\" \")\n      .map((part) => part[0])\n      .join(\"\")\n      .toUpperCase()\n      .slice(0, 2);\n  };\n\n  return (\n    <div \n      onClick={handleCardClick}\n      className=\"block transition-colors hover:bg-muted/50 cursor-pointer rounded-lg relative\"\n      role=\"button\"\n      tabIndex={0}\n      onKeyDown={(e: React.KeyboardEvent<HTMLDivElement>) => {\n        if (e.key === \"Enter\" || e.key === \" \") {\n          e.preventDefault();\n          router.push(`/post/${post.id}`);\n        }\n      }}\n    >\n      <article className=\"p-4\">\n        <div className=\"flex gap-3\">\n          {/* Avatar link */}\n          <div className=\"relative z-10\">\n            <Link \n              href={`/profile/${post.username}`} \n              onClick={handleProfileLinkClick}\n              className=\"inline-block\"\n              aria-label={`View ${post.display_name}'s profile`}\n            >\n              <Avatar className=\"h-10 w-10\">\n                <AvatarImage \n                  src={post.avatar_url || undefined} \n                  alt={post.display_name} \n                />\n                <AvatarFallback className=\"text-sm\">\n                  {getInitials(post.display_name)}\n                </AvatarFallback>\n              </Avatar>\n            </Link>\n          </div>\n\n          <div className=\"flex-1 space-y-2\">\n            {/* User info and timestamp */}\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-2 flex-wrap\">\n                <Link\n                  href={`/profile/${post.username}`}\n                  onClick={handleProfileLinkClick}\n                  className=\"font-semibold hover:underline focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring\"\n                  aria-label={`View ${post.display_name}'s profile`}\n                >\n                  {post.display_name}\n                </Link>\n                \n                <Link\n                  href={`/profile/${post.username}`}\n                  onClick={handleProfileLinkClick}\n                  className=\"text-muted-foreground text-sm hover:underline focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring\"\n                  aria-label={`View @${post.username}'s profile`}\n                >\n                  @{post.username}\n                </Link>\n                \n                <span className=\"text-muted-foreground text-sm\">·</span>\n                \n                <span className=\"text-muted-foreground text-sm\">\n                  {formatDistanceToNow(new Date(post.created_at), { addSuffix: true })}\n                </span>\n              </div>\n\n              {/* Follow button (desno) */}\n              {showFollowButton && isAuthenticated && currentUser && currentUser !== post.user_id && (\n                <div className=\"relative z-20\" onClick={(e) => e.stopPropagation()}>\n                  <FollowButton\n                    followerId={currentUser}\n                    followingId={post.user_id}\n                    isFollowing={isFollowing}\n                    onFollowChange={handleFollowStatusChange}\n                  />\n                </div>\n              )}\n            </div>\n\n            {/* Post content */}\n            <p className=\"whitespace-pre-wrap text-pretty break-words\">{post.content}</p>\n\n            {/* Actions */}\n            <div className=\"flex items-center gap-6\">\n              {/* Comment button */}\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                className=\"h-8 gap-2 px-2 text-muted-foreground hover:text-primary relative z-10\"\n                onClick={handleCommentButtonClick}\n                type=\"button\"\n                aria-label={`${isAuthenticated ? `View comments (${post.comments_count})` : 'Sign in to comment'}`}\n              >\n                <MessageCircle className=\"h-4 w-4\" />\n                <span className=\"text-sm\">{post.comments_count}</span>\n                {!isAuthenticated && (\n                  <span className=\"absolute -top-1 -right-1\">\n                    <LogIn className=\"h-3 w-3 text-muted-foreground\" />\n                  </span>\n                )}\n              </Button>\n\n              {/* Like button */}\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                className={`h-8 gap-2 px-2 relative z-10 ${\n                  liked ? \"text-red-500 hover:text-red-600\" : \"text-muted-foreground hover:text-red-500\"\n                }`}\n                onClick={handleLike}\n                disabled={loading || (!isAuthenticated && !liked)}\n                type=\"button\"\n                aria-label={`${isAuthenticated ? (liked ? \"Unlike\" : \"Like\") : \"Sign in to like\"} post (${likesCount} likes)`}\n              >\n                <Heart className={`h-4 w-4 ${liked ? \"fill-current\" : \"\"}`} />\n                <span className=\"text-sm\">{likesCount}</span>\n                {!isAuthenticated && !liked && (\n                  <span className=\"absolute -top-1 -right-1\">\n                    <LogIn className=\"h-3 w-3 text-muted-foreground\" />\n                  </span>\n                )}\n              </Button>\n\n              {/* Indikator da treba login */}\n              {!isAuthenticated && (\n                <span className=\"text-xs text-muted-foreground\">\n                  Sign in to interact\n                </span>\n              )}\n            </div>\n          </div>\n        </div>\n      </article>\n    </div>\n  );\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 578, "column": 0}, "map": {"version":3,"sources":["file:///D:/GitHubNovi/Nexus/components/feed/feed.tsx"],"sourcesContent":["// components/feed/feed.tsx\n\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { createClient } from \"@/lib/supabase/client\";\nimport { PostCard } from \"@/components/post/post-card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Loader2, RefreshCw } from \"lucide-react\";\n\ninterface Post {\n  id: string;\n  content: string;\n  created_at: string;\n  user_id: string;\n  username: string;\n  display_name: string;\n  avatar_url: string | null;\n  likes_count: number;\n  comments_count: number;\n  user_has_liked: boolean;\n}\n\ninterface FeedProps {\n  userId?: string;\n  followingUserIds?: string[];\n  isAuthenticated?: boolean;\n  showFollowButton?: boolean;\n  onFollowChange?: (userId: string, isFollowing: boolean) => void;\n}\n\nexport function Feed({ \n  userId, \n  followingUserIds, \n  isAuthenticated = false,\n  showFollowButton = false,\n  onFollowChange\n}: FeedProps) {\n  const [posts, setPosts] = useState<Post[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [followingPosts, setFollowingPosts] = useState<Post[]>([]);\n  const [otherPosts, setOtherPosts] = useState<Post[]>([]);\n  const [showAll, setShowAll] = useState(false);\n  const [currentFollowingIds, setCurrentFollowingIds] = useState<string[]>(followingUserIds || []);\n\n  useEffect(() => {\n    if (followingUserIds) {\n      setCurrentFollowingIds(followingUserIds);\n    }\n  }, [followingUserIds]);\n\n  useEffect(() => {\n    void fetchPosts();\n  }, [userId, followingUserIds, isAuthenticated]);\n\n  const handleFollowChange = (userId: string, isFollowing: boolean) => {\n    if (isFollowing) {\n      // Dodaj u listu pratilaca\n      setCurrentFollowingIds(prev => [...prev, userId]);\n    } else {\n      // Ukloni iz liste pratilaca\n      setCurrentFollowingIds(prev => prev.filter(id => id !== userId));\n    }\n\n    // Pozovi callback ako postoji\n    onFollowChange?.(userId, isFollowing);\n  };\n\n  async function fetchPosts() {\n    const supabase = createClient();\n    setLoading(true);\n    setError(null);\n\n    try {\n      // Prvo dohvati sve postove\n      const { data: allPosts, error: fetchError } = await supabase\n        .from(\"posts\")\n        .select(\n          `\n          *,\n          profiles!posts_user_id_fkey(username, display_name, avatar_url)\n        `\n        )\n        .order(\"created_at\", { ascending: false })\n        .limit(100);\n\n      if (fetchError) {\n        console.error(\"[v0] Error fetching posts:\", fetchError);\n        if (fetchError.message?.includes(\"Could not find the table\")) {\n          setError(\"database_not_setup\");\n        } else {\n          setError(fetchError.message);\n        }\n        setLoading(false);\n        return;\n      }\n\n      if (!allPosts || allPosts.length === 0) {\n        setPosts([]);\n        setLoading(false);\n        return;\n      }\n\n      // Formatiraj sve postove\n      const formattedAllPosts = await Promise.all(\n        allPosts.map(async (post) => {\n          const { count: likesCount } = await supabase\n            .from(\"likes\")\n            .select(\"*\", { count: \"exact\", head: true })\n            .eq(\"post_id\", post.id);\n\n          const { count: commentsCount } = await supabase\n            .from(\"comments\")\n            .select(\"*\", { count: \"exact\", head: true })\n            .eq(\"post_id\", post.id);\n\n          let userHasLiked = false;\n          if (userId) {\n            const { data: like } = await supabase\n              .from(\"likes\")\n              .select(\"id\")\n              .eq(\"post_id\", post.id)\n              .eq(\"user_id\", userId)\n              .maybeSingle();\n            userHasLiked = !!like;\n          }\n\n          return {\n            id: post.id,\n            content: post.content,\n            created_at: post.created_at,\n            user_id: post.user_id,\n            username: post.profiles.username,\n            display_name: post.profiles.display_name,\n            avatar_url: post.profiles.avatar_url,\n            likes_count: likesCount ?? 0,\n            comments_count: commentsCount ?? 0,\n            user_has_liked: userHasLiked,\n          };\n        })\n      );\n\n      // Ako je korisnik logovan i ima pratilaca\n      if (isAuthenticated && currentFollowingIds && currentFollowingIds.length > 0) {\n        const following = formattedAllPosts.filter((post) =>\n          currentFollowingIds.includes(post.user_id)\n        );\n        const other = formattedAllPosts.filter(\n          (post) => !currentFollowingIds.includes(post.user_id)\n        );\n\n        setFollowingPosts(following);\n        setOtherPosts(other);\n        \n        // Prvo prikaži postove od pratilaca\n        if (following.length > 0) {\n          setPosts(following);\n        } else {\n          setPosts(other);\n          setShowAll(true);\n        }\n      } else {\n        // Ako nije logovan ili nema pratilaca, prikaži sve\n        setPosts(formattedAllPosts);\n        setFollowingPosts([]);\n        setOtherPosts(formattedAllPosts);\n        setShowAll(true);\n      }\n    } catch (err) {\n      console.error(\"Error fetching posts:\", err);\n      setError(err instanceof Error ? err.message : \"Unknown error\");\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  const handleShowAll = () => {\n    if (followingPosts.length > 0 && otherPosts.length > 0) {\n      setPosts([...followingPosts, ...otherPosts]);\n      setShowAll(true);\n    }\n  };\n\n  const handleShowFollowing = () => {\n    if (followingPosts.length > 0) {\n      setPosts(followingPosts);\n      setShowAll(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"p-8 text-center text-muted-foreground\">\n        <Loader2 className=\"h-6 w-6 animate-spin mx-auto mb-2\" />\n        <p>Loading feed...</p>\n      </div>\n    );\n  }\n\n  if (error === \"database_not_setup\") {\n    return (\n      <div className=\"p-8 text-center\">\n        <p className=\"text-muted-foreground mb-2\">Database not set up</p>\n        <p className=\"text-muted-foreground text-sm\">\n          Run the SQL scripts to create the necessary tables\n        </p>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"p-8 text-center\">\n        <p className=\"text-destructive mb-2\">Error loading feed</p>\n        <p className=\"text-muted-foreground text-sm\">{error}</p>\n        <Button onClick={fetchPosts} variant=\"outline\" className=\"mt-4\">\n          <RefreshCw className=\"h-4 w-4 mr-2\" />\n          Try Again\n        </Button>\n      </div>\n    );\n  }\n\n  if (posts.length === 0) {\n    return (\n      <div className=\"p-8 text-center\">\n        <p className=\"text-muted-foreground mb-2\">No posts yet</p>\n        <p className=\"text-muted-foreground text-sm\">\n          {isAuthenticated\n            ? \"Be the first to share something or follow some users!\"\n            : \"Be the first to share something!\"}\n        </p>\n        {isAuthenticated && (\n          <Button onClick={fetchPosts} variant=\"outline\" className=\"mt-4\">\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\n            Refresh\n          </Button>\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <div>\n      {/* Filter dugmad - samo ako ima pratilaca */}\n      {isAuthenticated && followingPosts.length > 0 && otherPosts.length > 0 && (\n        <div className=\"sticky top-14 z-10 bg-background/80 backdrop-blur-sm border-b px-4 py-2\">\n          <div className=\"flex gap-2\">\n            <Button\n              variant={showAll ? \"outline\" : \"default\"}\n              size=\"sm\"\n              onClick={handleShowFollowing}\n              className=\"text-xs\"\n            >\n              Following ({followingPosts.length})\n            </Button>\n            <Button\n              variant={showAll ? \"default\" : \"outline\"}\n              size=\"sm\"\n              onClick={handleShowAll}\n              className=\"text-xs\"\n            >\n              All Posts ({followingPosts.length + otherPosts.length})\n            </Button>\n          </div>\n        </div>\n      )}\n\n      {/* Poruka ako prikazujemo samo pratilce */}\n      {isAuthenticated && !showAll && followingPosts.length === 0 && (\n        <div className=\"p-4 text-center border-b\">\n          <p className=\"text-muted-foreground text-sm\">\n            No posts from users you follow.{\" \"}\n            <button\n              onClick={handleShowAll}\n              className=\"text-primary hover:underline\"\n            >\n              Show all posts\n            </button>\n          </p>\n        </div>\n      )}\n\n      {/* Postovi */}\n      <div className=\"divide-y\">\n        {posts.map((post) => (\n          <PostCard \n            key={post.id} \n            post={post}\n            showFollowButton={showFollowButton && isAuthenticated}\n            currentUserId={userId}\n            isCurrentUserFollowing={currentFollowingIds.includes(post.user_id)}\n            onFollowChange={handleFollowChange}\n          />\n        ))}\n      </div>\n\n      {/* Poruka ako ima više postova */}\n      {isAuthenticated && !showAll && otherPosts.length > 0 && (\n        <div className=\"p-4 text-center border-t\">\n          <p className=\"text-muted-foreground text-sm\">\n            Showing {followingPosts.length} posts from users you follow.{\" \"}\n            <button\n              onClick={handleShowAll}\n              className=\"text-primary hover:underline\"\n            >\n              Show {otherPosts.length} more posts\n            </button>\n          </p>\n        </div>\n      )}\n    </div>\n  );\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1011, "column": 0}, "map": {"version":3,"sources":["file:///D:/GitHubNovi/Nexus/components/ui/alert.tsx"],"sourcesContent":["import * as React from 'react'\nimport { cva, type VariantProps } from 'class-variance-authority'\n\nimport { cn } from '@/lib/utils'\n\nconst alertVariants = cva(\n  'relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current',\n  {\n    variants: {\n      variant: {\n        default: 'bg-card text-card-foreground',\n        destructive:\n          'text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n    },\n  },\n)\n\nfunction Alert({\n  className,\n  variant,\n  ...props\n}: React.ComponentProps<'div'> & VariantProps<typeof alertVariants>) {\n  return (\n    <div\n      data-slot=\"alert\"\n      role=\"alert\"\n      className={cn(alertVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction AlertTitle({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"alert-title\"\n      className={cn(\n        'col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction AlertDescription({\n  className,\n  ...props\n}: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"alert-description\"\n      className={cn(\n        'text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Alert, AlertTitle, AlertDescription }\n"],"names":[],"mappings":";;;;;;;;;AACA;AAEA;;;;AAEA,MAAM,gBAAgB,IAAA,uKAAG,EACvB,qOACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,SAAS,MAAM,EACb,SAAS,EACT,OAAO,EACP,GAAG,OAC8D;IACjE,qBACE,8OAAC;QACC,aAAU;QACV,MAAK;QACL,WAAW,IAAA,kHAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,+DACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,iBAAiB,EACxB,SAAS,EACT,GAAG,OACyB;IAC5B,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,kGACA;QAED,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 1077, "column": 0}, "map": {"version":3,"sources":["file:///D:/GitHubNovi/Nexus/components/ui/skeleton.tsx"],"sourcesContent":["// components/ui/skeleton.tsx\nexport function Skeleton({ className = \"\", ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={`animate-pulse rounded-md bg-muted ${className}`}\n      {...props}\n    />\n  );\n}"],"names":[],"mappings":"AAAA,6BAA6B;;;;;;;AACtB,SAAS,SAAS,EAAE,YAAY,EAAE,EAAE,GAAG,OAA6C;IACzF,qBACE,8OAAC;QACC,WAAW,CAAC,kCAAkC,EAAE,WAAW;QAC1D,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 1098, "column": 0}, "map": {"version":3,"sources":["file:///D:/GitHubNovi/Nexus/components/ui/switch.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as SwitchPrimitive from '@radix-ui/react-switch'\n\nimport { cn } from '@/lib/utils'\n\nfunction Switch({\n  className,\n  ...props\n}: React.ComponentProps<typeof SwitchPrimitive.Root>) {\n  return (\n    <SwitchPrimitive.Root\n      data-slot=\"switch\"\n      className={cn(\n        'peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50',\n        className,\n      )}\n      {...props}\n    >\n      <SwitchPrimitive.Thumb\n        data-slot=\"switch-thumb\"\n        className={\n          'bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0'\n        }\n      />\n    </SwitchPrimitive.Root>\n  )\n}\n\nexport { Switch }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,OAAO,EACd,SAAS,EACT,GAAG,OAC+C;IAClD,qBACE,8OAAC,0KAAoB;QACnB,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,6WACA;QAED,GAAG,KAAK;kBAET,cAAA,8OAAC,2KAAqB;YACpB,aAAU;YACV,WACE;;;;;;;;;;;AAKV"}},
    {"offset": {"line": 1133, "column": 0}, "map": {"version":3,"sources":["file:///D:/GitHubNovi/Nexus/components/ui/label.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as LabelPrimitive from '@radix-ui/react-label'\n\nimport { cn } from '@/lib/utils'\n\nfunction Label({\n  className,\n  ...props\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\n  return (\n    <LabelPrimitive.Root\n      data-slot=\"label\"\n      className={cn(\n        'flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Label }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,MAAM,EACb,SAAS,EACT,GAAG,OAC8C;IACjD,qBACE,8OAAC,yKAAmB;QAClB,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,uNACA;QAED,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 1160, "column": 0}, "map": {"version":3,"sources":["file:///D:/GitHubNovi/Nexus/app/home/page.tsx"],"sourcesContent":["// app/home/page.tsx - Ažurirana verzija\n\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { createClient } from \"@/lib/supabase/client\";\nimport { Feed } from \"@/components/feed/feed\";\nimport { Alert, AlertDescription, AlertTitle } from \"@/components/ui/alert\";\nimport { AlertCircle, Users } from \"lucide-react\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Label } from \"@/components/ui/label\";\n\nexport default function HomePage(): React.JSX.Element {\n  const [user, setUser] = useState<any>(null);\n  const [profile, setProfile] = useState<any>(null);\n  const [followingUserIds, setFollowingUserIds] = useState<string[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [databaseError, setDatabaseError] = useState<string | null>(null);\n  const [showFollowButtons, setShowFollowButtons] = useState(true);\n\n  const supabase = createClient();\n\n  useEffect(() => {\n    fetchUserData();\n  }, []);\n\n  async function fetchUserData() {\n    try {\n      setIsLoading(true);\n      \n      // Dohvati trenutnog korisnika\n      const { data: { user: currentUser } } = await supabase.auth.getUser();\n      setUser(currentUser);\n\n      if (currentUser) {\n        // Dohvati profil\n        const { data: userProfile } = await supabase\n          .from(\"profiles\")\n          .select(\"*\")\n          .eq(\"id\", currentUser.id)\n          .maybeSingle();\n        setProfile(userProfile);\n\n        // Dohvati korisnike koje prati\n        const { data: follows } = await supabase\n          .from(\"follows\")\n          .select(\"following_id\")\n          .eq(\"follower_id\", currentUser.id);\n        \n        const followingIds = follows?.map(follow => follow.following_id) || [];\n        setFollowingUserIds([...followingIds, currentUser.id]); // Dodaj i sebe\n\n        // Provjera da li tabela postoji\n        const { error: profileError } = await supabase\n          .from(\"profiles\")\n          .select(\"id\")\n          .limit(1);\n        \n        if (profileError?.message?.includes(\"Could not find the table\")) {\n          setDatabaseError(\"database_not_setup\");\n        }\n      }\n    } catch (error) {\n      console.error(\"Error fetching user data:\", error);\n    } finally {\n      setIsLoading(false);\n    }\n  }\n\n  const handleFollowChange = (userId: string, isFollowing: boolean) => {\n    if (isFollowing) {\n      // Dodaj u listu pratilaca\n      setFollowingUserIds(prev => [...prev, userId]);\n    } else {\n      // Ukloni iz liste pratilaca\n      setFollowingUserIds(prev => prev.filter(id => id !== userId));\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"mx-auto max-w-2xl p-4\">\n        <div className=\"mb-8\">\n          <Skeleton className=\"h-8 w-48 mb-2\" />\n          <Skeleton className=\"h-4 w-64\" />\n        </div>\n        <div className=\"space-y-4\">\n          {[...Array(3)].map((_, i) => (\n            <div key={i} className=\"p-6 border rounded-lg\">\n              <div className=\"flex items-center gap-3 mb-4\">\n                <Skeleton className=\"h-10 w-10 rounded-full\" />\n                <div>\n                  <Skeleton className=\"h-4 w-32 mb-1\" />\n                  <Skeleton className=\"h-3 w-24\" />\n                </div>\n                <Skeleton className=\"h-8 w-24 ml-auto\" />\n              </div>\n              <Skeleton className=\"h-20 w-full\" />\n            </div>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  if (databaseError === \"database_not_setup\") {\n    return (\n      <div className=\"mx-auto max-w-2xl p-4\">\n        <Alert>\n          <AlertCircle className=\"h-4 w-4\" />\n          <AlertTitle>Database Setup Required</AlertTitle>\n          <AlertDescription>\n            The database tables haven't been created yet. Please run the SQL scripts in the{\" \"}\n            <code className=\"rounded bg-muted px-1 py-0.5\">scripts</code> folder to set up your database.\n          </AlertDescription>\n        </Alert>\n      </div>\n    );\n  }\n\n  const isAuthenticated = !!user;\n\n  return (\n    <div className=\"mx-auto max-w-2xl p-4\">\n      <div className=\"mb-8\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-bold\">\n              {isAuthenticated ? \"Home\" : \"Explore Posts\"}\n            </h1>\n            <p className=\"text-muted-foreground mt-2\">\n              {isAuthenticated \n                ? \"Your personalized feed\" \n                : \"Sign in to see posts from people you follow\"}\n            </p>\n          </div>\n          \n          {isAuthenticated && (\n            <div className=\"flex items-center gap-4\">\n              <div className=\"flex items-center gap-2 text-sm\">\n                <Users className=\"h-4 w-4\" />\n                <span>Following: {followingUserIds.length - 1}</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <Switch\n                  id=\"follow-buttons\"\n                  checked={showFollowButtons}\n                  onCheckedChange={setShowFollowButtons}\n                />\n                <Label htmlFor=\"follow-buttons\" className=\"text-sm\">\n                  Show follow buttons\n                </Label>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      <Feed \n        userId={user?.id}\n        followingUserIds={followingUserIds}\n        isAuthenticated={isAuthenticated}\n        showFollowButton={showFollowButtons}\n        onFollowChange={handleFollowChange}\n      />\n    </div>\n  );\n}"],"names":[],"mappings":"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"}}]
}